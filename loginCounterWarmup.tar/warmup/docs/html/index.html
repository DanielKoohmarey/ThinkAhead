<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>CS169 Warmup Project: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CS169 Warmup Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">CS169 Warmup Project Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>CS169 Warmup Project is a simple project designed as a quick tutorial for building and deploying a web app for students in the CS169 class. The implementation documented here does not use any web framework, but is otherwise fully functional. The tests included with this implementation can be used as functional and acceptance tests for other implementations as well.</p>
<p>The description for this project is at: <a href="https://sites.google.com/site/ucbcs169sp14/project/warmupproject">https://sites.google.com/site/ucbcs169sp14/project/warmupproject</a></p>
<h2>Project Specification</h2>
<ul>
<li>The class <a class="el" href="classserver_1_1_users_model.html" title="This is essentially the Model in a MVC architecture.">server.UsersModel</a> contains the specification for your model<ul>
<li>This entire documentation is generated using doxygen from comments in the Python files and *.md files (markdown format). This allows those parts of the documentation that are tied to the code to stay close to the code itself.</li>
</ul>
</li>
<li>The client-server protocol uses JSON with the following <a href="schemas.html">schemas</a><ul>
<li>The schema documentation is also extracted from the code by <a class="el" href="schema_by_example.html">Schemas By Example</a></li>
</ul>
</li>
</ul>
<h2>Installation</h2>
<ul>
<li>Unpack the loginCounterWarmup.tar.gz.</li>
</ul>
<h2>Running the server</h2>
<ul>
<li><p class="startli">You need to have python 2.x (&gt;= 2.6) installed </p>
<pre class="fragment">python server.py
</pre><ul>
<li>this will run a web server on port 5000 on localhost</li>
</ul>
</li>
</ul>
<ul>
<li>To manually test the mock server using the HTML client:<ul>
<li>open a browser and point it to <a href="http://localhost:5000/client.html">http://localhost:5000/client.html</a></li>
</ul>
</li>
</ul>
<ul>
<li><p class="startli">To run unit tests for the mock server backend: </p>
<pre class="fragment">make unit_tests
</pre><ul>
<li>This will run the unit tests specified in <a class="el" href="classserver_test_1_1_test_users.html" title="Unittests for the Users model class (a sample, incomplete)">serverTest.TestUsers</a></li>
<li>These unit tests are specific to the way the mock server is implemented. You will have to write your own unit tests using the conventions of the framework you are using.</li>
</ul>
</li>
</ul>
<ul>
<li><p class="startli">To run functional tests for the mock server backend: </p>
<pre class="fragment"># start a server
python server.py
make func_tests
</pre><ul>
<li>This will issue requests to localhost:5000 and will check the results</li>
<li>The actual test specification are collected from all the test*.py files in the current directory (using Python standard unittest framework)</li>
<li>By default we are giving you the test in <a class="el" href="classtest_simple_1_1_test_unit.html" title="Issue a REST API request to run the unit tests, and analyze the result.">testSimple.TestUnit</a> (the same tests as the <a class="el" href="classserver_test_1_1_test_users.html" title="Unittests for the Users model class (a sample, incomplete)">serverTest.TestUsers</a> unit tests but executed through the HTTP api), and <a class="el" href="classtest_simple_1_1_test_add_user.html" title="Test adding users.">testSimple.TestAddUser</a></li>
</ul>
<ul>
<li>To run functional tests against some other running backend <pre class="fragment"># start your backend, e.g., on Heroku at myapp.herokuapp.com
make func_tests TEST_SERVER=myapp.herokuapp.com
</pre></li>
</ul>
<ul>
<li>the TEST_SERVER environment variable can be set to the hostname:port for the server to test (defaults to localhost:5000)</li>
<li>We will grade your project by running these tests, the tests you will provide in testAdditional, and other test too ...</li>
</ul>
</li>
</ul>
<h2>Writing more tests</h2>
<ul>
<li>You should write more functional tests, in Python, following the model of the tests in testSimple.py. Put your tests in a file "testAdditional.py" next to testSimple.py. The "test" prefix of the name is required by the unittest framework, the rest is a requirement of our grading script.</li>
</ul>
<h2>Heroku deployment details</h2>
<p>The course web page has more extensive documentation about deploying to Heroku. This section documents the specific difficulties that I ran into when deploying these project.</p>
<p>Deploying this app to Heroku was not trivial. Here is what worked:</p>
<ul>
<li>install virtualenv<ul>
<li>On Mac OSX with my python setup the permissions were missing the execute bit: <pre class="fragment">  INSTALL_DIR=/opt/local/Library/Frameworks/Python.framework/Versions/2.7
  sudo chmod a+x $INSTALL_DIR/bin/virtualenv*
  sudo chmod a+x $INSTALL_DIR/lib/python2.7/site-packages/virtualenv-1.8.4-py2.7.egg-info
  sudo chmod a+x $INSTALL_DIR/lib/python2.7/site-packages/virtualenv_support
</pre></li>
</ul>
</li>
<li>run virtualenv in the local project directory <pre class="fragment">    PATH=$INSTALL_DIR/bin:$PATH virtualenv --distribute venv
</pre></li>
<li>this will create a venv subdirectory. Add it to .gitignore</li>
<li>activate this virtual environment source venv/bin/activate</li>
<li>generate the requirements.txt (this must exist for Python projects in Heroku) <pre class="fragment">pip freeze &gt;requirements.txt
</pre></li>
<li>generate the Procfile</li>
</ul>
<ul>
<li>try to run the project locally: <pre class="fragment">foreman start (also make start_local)
</pre></li>
</ul>
<ul>
<li><p class="startli">Create the Heroku app heroku create</p>
<ul>
<li>Here you will normally see that the git remote is added (git remote v). In my case, it wasn't. This was because the project was in a subdirectory (project/warmup) and heroku did not find the .git directory. This created lots of problems, because everytime I pushed to Heroku I was getting "Heroku push rejected, no Cedar-supported app
       detected". It took me a while to figure this out.</li>
<li>Now I use "git subtree" (see Makefile)</li>
</ul>
<ul>
<li>I had trouble getting the app started because it was using the wrong port. The solution was to write the app to read the value of the PORT environment variable and use it as a port number.</li>
</ul>
</li>
</ul>
<ul>
<li>A very useful command for debugging this was: <pre class="fragment">heroku logs -t --app myapp</pre> </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
</body>
</html>
